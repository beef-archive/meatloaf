(function(y,a,d,S,O,L,C,Te,W,D,R){"use strict";function z(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function G(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),r.default=e,Object.freeze(r)}var t=G(O),m=z(W);const[{getChannel:Y},{getGuild:J},{getCurrentUser:V},{getUser:q},{getMessage:H},{getToken:K}]=d.batchFind(({findByProps:e,findByDisplayName:r,findByDisplayNameAll:n})=>{e("hasChannel"),e("getGuild"),e("getCurrentUser"),e("getUser"),e("getMessages"),e("getToken")}),Q={modules:{getChannel:Y,getGuild:J,getCurrentUser:V,getUser:q,getMessage:H,getToken:K}};function I(){return a.persist.ghost.generalExposeObject&&!window.Meddle?window.Meddle=Q:!a.persist.ghost.generalExposeObject&&window.Meddle&&delete window.Meddle,()=>{delete window.Meddle}}const[Ae,h,w,u,l,P,o,X,T,Z,ee,A,g,b,v,M,{GuildFeatures:Me},{joinGuild:te},{getCurrentUser:B},{findActivity:re},{SpotifyAPI:ne},{SpotifyEndpoints:se},{getActiveSocketAndDevice:ie,getActivity:ae,shouldShowActivity:le}]=d.batchFind(({findByProps:e,findByDisplayName:r})=>{r("SettingsView"),e("dirtyDispatch"),r("FormTitle"),r("FormText"),r("FormDivider"),r("Switch"),e("Sizes","Colors","Looks","DropdownSizes"),r("TextInput"),r("TabBar"),e("topPill"),e("tabBar","nowPlayingColumn"),r("UserActivityContainer"),e("userPopout","body"),e("activity","note"),e("scrollerBase","thin"),e("contentImagesProfile"),e("GuildFeatures"),e("joinGuild"),e("getCurrentUser"),e("getApplicationActivities"),e("SpotifyAPI"),e("SpotifyEndpoints"),e("getActiveSocketAndDevice")});function oe(e){return t.createElement("div",null,t.createElement(w,{style:{marginBottom:"0.2rem"},tag:"h1"},"Meddle"),t.createElement(u,null,"A tool for those who like to mess with the Maze."))}function ce({items:e}){let[r,n]=t.useState(0);return t.createElement("div",null,t.createElement("div",{className:"beef-meddle-card"},t.createElement(oe,null),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement(T,{type:Z.topPill,className:ee.tabBar,selectedItem:r,onItemSelect:n},e.map((i,c)=>t.createElement(T.Item,{id:c},i.text)))),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement("div",{className:"beef-meddle-settings-section beef-meddle-card"},t.createElement(L.ErrorBoundary,null,t.createElement(e[r].component,{goTo:n}))))}function de({text:e,subtext:r,checked:n,onChange:i}){return t.createElement("div",{class:"beef-meddle-switch"},t.createElement(P,{checked:n,onChange:i}),t.createElement(u,null,e,t.createElement(u,{class:"beef-meddle-subtext"},r)))}function me(e){return t.createElement("div",null,t.createElement(de,{text:"Expose a Meddle object on the window",subtext:"This contains several utilities such as some common Webpack modules.",checked:a.persist.ghost.generalExposeObject,onChange:r=>{a.persist.store.generalExposeObject=r,I()}}))}const j=d.findByDisplayName("FormText"),ue=d.findByDisplayName("Switch"),pe=d.findByDisplayName("TextInput");d.findByDisplayName("Select",!1).SingleSelect;const U=e=>({display:"flex",alignItems:"center",gap:".5rem",marginBottom:"1rem",marginLeft:e!==void 0?"1rem":0}),fe=({k:e,depends:r,children:n})=>m.default.createElement("div",{style:U(r)},m.default.createElement(ue,{checked:a.persist.ghost[e],disabled:r!==void 0&&!a.persist.ghost[r],onChange:i=>a.persist.store[e]=i}),m.default.createElement(j,{children:n})),he=({k:e,depends:r,children:n})=>m.default.createElement("div",{style:U(r)},m.default.createElement(pe,{value:a.persist.ghost[e],disabled:r!==void 0&&!a.persist.ghost[r],onChange:i=>a.persist.store[e]=i}),m.default.createElement(j,{children:n})),ge=e=>r=>(C.useNest(a.persist),e(r)),be=(e,r=a.persist)=>{for(const n in e)r.ghost[n]===void 0&&(r.store[n]=e[n])};function x({k:e,depends:r,children:n}){return t.createElement("div",{class:"beef-meddle-persist-textbox-wrapper"},t.createElement(he,{k:e,depends:r},n))}function N({k:e,depends:r,children:n}){return t.createElement("div",{class:"beef-meddle-persist-switch-wrapper"},t.createElement(fe,{k:e,depends:r},n))}function ve(e){return t.createElement("div",null,t.createElement("div",{class:"beef-meddle-column"},t.createElement(N,{k:"dispatchLogEnabled"},"Log all FluxDispatcher calls to console"),t.createElement(N,{k:"dispatchWhiteListMode"},"Dispatch logger whitelist mode")),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement("div",{class:"beef-meddle-column"},t.createElement(x,{k:"dispatchIgnoreList"},"FluxDispatcher calls to hide when not in whitelist mode (comma separated)"),t.createElement(x,{k:"dispatchWhiteList"},"FluxDispatcher calls to allow when in whitelist mode (comma separated)")))}function $({text:e,color:r,size:n,look:i,func:c,style:s}){return t.createElement(o,{style:s,color:o.Colors[r]||o.Colors.BRAND,size:o.Sizes[n]||o.Sizes.SMALL,look:o.Looks[i]||o.Looks.FILLED,onClick:c},e)}function Ee(e){return t.createElement("div",null,t.createElement(x,{k:"serverId"},"Server ID"),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement("div",{class:"beef-meddle-row"},t.createElement(N,{k:"serverLurkMode"},"Join as lurker"),t.createElement($,{style:{marginLeft:"auto"},text:"Join",size:"SMALL",func:async()=>{te(a.persist.ghost.serverId,{lurker:a.persist.ghost.serverLurkMode})}})))}const F={isPlaying:!1,position:0,track:{name:"Song Name",album:{image:{url:"https://raw.githubusercontent.com/Cumcord/assets/main/logo/filled.svg"},name:"Album Name"},duration:0,artists:[{name:"Artist Name",external_urls:{},href:{},id:"stub",type:"artist",url:"Artist URL"}]}},p=D.nests.make(Object.assign({},F)),E=ie()?.socket;E!==void 0&&ne.get(E.accountId,E.accessToken,{url:se.PLAYER}).then(e=>e.body).then(e=>{const r={accountId:E.accountId,track:{id:e.item.id,name:e.item.name,duration:e.item.duration_ms,album:{id:e.item.album.id,name:e.item.album.name,image:e.item.album.images[0]},artists:e.item.artists,isLocal:e.item.is_local||!0},volumePercent:e?.device.volume_percent??0,isPlaying:e.is_playing,repeat:e.repeat_state!=="off",position:e.progress_ms,context:e.context,device:e.devicecs};for(const n in r)p.store[n]=r[n]});function ye(e){for(let r of Object.keys(p.ghost))p.store[r]=e.track||e.context?e[r]:F[r]}function f({value:e,onChange:r,variant:n="column",fixedWidth:i,children:c}){if(n!=="column"&&n!=="row")throw new Error("Component Error - Textbox: variant should be column (default) or row");return t.createElement("div",{class:n==="column"?"beef-meddle-column":"beef-meddle-row beef-meddle-center"},t.createElement(u,{style:i?{width:i}:{}},c),t.createElement(X,{value:e,onChange:r}))}function we(e){C.useNest(p);const r=p.store,n=p.ghost;let i=ae();i&&(i.type=constants.ActivityTypes.LISTENING);const[,c]=t.useReducer(s=>~s,0);return t.createElement("div",null,t.createElement("div",{className:"beef-meddle-row"},t.createElement("div",{className:"beef-meddle-row beef-meddle-center"},t.createElement("img",{src:n.track.album.image.url,height:"120",width:"120"}),t.createElement("div",{className:"beef-meddle-column"},t.createElement(f,{fixedWidth:"0.75rem",variant:"row",value:n.track.name,onChange:s=>{r.track.name=s}}),t.createElement(f,{fixedWidth:"0.75rem",variant:"row",value:n.track.artists.map(s=>s.name).join(", "),onChange:s=>{r.track.artists=s.split(", ").map(Pe=>({name:Pe,external_urls:{},href:{},id:"stub",type:"artist",url:"Artist URL"}))}},"by"),t.createElement(f,{fixedWidth:"0.75rem",variant:"row",value:n.track.album.name,onChange:s=>{r.track.album.name=s}},"on"))),t.createElement("div",{className:"beef-meddle-column",style:{marginLeft:"auto"}},t.createElement($,{text:"Dispatch",size:"MEDIUM",func:async()=>{h.dispatch({...n,type:"SPOTIFY_PLAYER_STATE"}),c()}}))),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement("div",{className:"beef-meddle-row"},t.createElement("div",{className:"beef-meddle-column"},t.createElement(f,{fixedWidth:"3rem",variant:"row",value:n.position,onChange:s=>{r.position=isNaN(s)||!s?void 0:parseInt(s)}},"Position (ms)"),t.createElement(f,{fixedWidth:"3rem",variant:"row",value:n.track.duration,onChange:s=>{r.track.duration=isNaN(s)||!s?void 0:parseInt(s)}},"Duration (ms)")),t.createElement("div",{className:"beef-meddle-row beef-meddle-center",style:{marginLeft:"auto"}},t.createElement(u,null,"Playing"),t.createElement(P,{checked:n.isPlaying,onChange:s=>{r.isPlaying=s}}))),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement(f,{value:n.track.album.image.url,onChange:s=>{r.track.album.image.url=s}},"Image URL (only supports ",t.createElement("code",null,"https://i.scdn.co/image/*")," urls)"),t.createElement(l,{className:"beef-meddle-divider"}),t.createElement(u,{className:"beef-meddle-subtext"},"If this is out of date/incorrect, try updating the current state of your Spotify player."),le()&&t.createElement("div",{className:"beef-meddle-preview-container",style:{display:"flex"}},t.createElement("div",{className:"beef-meddle-preview-unit"},t.createElement(w,{tag:"h5"},"Live preview"),t.createElement("div",{className:`beef-meddle-preview ${[g.userPopout,g.body,v.scrollerBase,v.thin,b.bodyInnerWrapper,b.activity,M.activityUserPopout].join(" ")}`},t.createElement(A,{type:"UserPopout",user:B(),activity:i}))),t.createElement("div",{className:"beef-meddle-preview-unit"},t.createElement(w,{tag:"h5"},"Currently shown"),t.createElement("div",{className:`beef-meddle-preview ${[g.userPopout,g.body,v.scrollerBase,v.thin,b.bodyInnerWrapper,b.activity,M.activityUserPopout].join(" ")}`},t.createElement(A,{type:"UserPopout",user:B(),activity:re(s=>s.type===constants.ActivityTypes.LISTENING)})))))}function xe(e){return t.createElement(L.ErrorBoundary,null,t.createElement("div",{className:"beef-meddle-settings"},t.createElement(ce,{items:[{text:"General",component:me},{text:"FluxDispatcher",component:ve},{text:"Servers",component:Ee},{text:"Spotify",component:we}]})))}var Ne=()=>R.registerSection("MEDDLE","Meddle",ge(xe));function ke(){return S.after("dispatch",h,e=>{!a.persist.ghost.dispatchLogEnabled||a.persist.ghost.dispatchWhiteListMode&&!a.persist.ghost.dispatchWhiteList.split(",").includes(e[0].type)||a.persist.ghost.dispatchIgnoreList.split(",").includes(e[0].type)||console.log(e[0])})}const k=new Map;k.set("SPOTIFY_PLAYER_STATE",ye);function Se(){for(const[e,r]of k)h.subscribe(e,r);return()=>{for(const[e,r]of k)h.unsubscribe(e,r)}}var Le=()=>S.injectCSS(".beef-meddle-row{display:flex;gap:.5rem}.beef-meddle-column{display:flex;flex-direction:column;gap:.5rem}.beef-meddle-divider{margin-top:.5rem;margin-bottom:.5rem}.beef-meddle-subtext{font-size:x-small;color:var(--text-muted)}.beef-meddle-card{padding:1rem;border-radius:.5rem;background-color:var(--background-secondary)}.beef-meddle-center{display:flex;justify-content:center;align-items:center}.beef-meddle-fullwidth{width:100%}.beef-meddle-fullwidth *{width:100%}.beef-meddle-persist-textbox-wrapper *{display:flex;flex-direction:column-reverse}.beef-meddle-persist-textbox-wrapper * *{width:100%}.beef-meddle-persist-switch-wrapper{display:flex}.beef-meddle-persist-switch-wrapper *{margin-bottom:0!important;align-items:center}.beef-meddle-switch{display:flex;align-items:center;gap:.5rem}.beef-meddle-preview-container{display:flex;justify-content:center;margin-top:16px}.beef-meddle-preview-unit{margin:0 auto}.beef-meddle-preview{width:300px;padding-top:16px}.beef-meddle-preview div img{top:16px!important;right:16px!important}");be({dispatchLogEnabled:!1,dispatchIgnoreList:"",dispatchWhiteList:"",dispatchWhiteListMode:!1,serverId:"",serverLurkMode:!1,generalExposeObject:!0});const Ce=[I(),Ne(),ke(),Se(),Le()];function Ie(){_.forEachRight(Ce,e=>e())}return y.onUnload=Ie,Object.defineProperty(y,"__esModule",{value:!0}),y})({},cumcord.pluginData,cumcord.modules.webpack,cumcord.patcher,cumcord.modules.common.React,cumcord.ui.components,cumcord.utils,cumcord.plugins,cumcord.modules.common.React,cumcord.modules.internal,cumcord.ui.userSettings);
